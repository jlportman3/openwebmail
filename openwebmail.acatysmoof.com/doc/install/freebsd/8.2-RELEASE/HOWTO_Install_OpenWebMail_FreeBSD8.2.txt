Overview
========
FreeBSD 8.2-RELEASE does not ship with Perl installed, and so any version
could be installed by the sysadmin. OpenWebMail supports all versions
of Perl, although versions 5.12.0 or greater no longer support setuid
and require the use of simple c wrappers to enable setuid.

If a Perl older than 5.12.0 is installed, it must support setuid.

This HOWTO was written on a FreeBSD system installed using the Standard
and Minimal settings from sysinstall - basically the most bare installation
possible. Most installations will have more of the needed software already
installed.

Make sure the following minimum requirements are installed before continuing.

Mimimum Requirements    Already Installed on FreeBSD 8.2-RELEASE?   How To Tell
====================    =========================================   ===========
- perl                  no                                          perl -v
- gcc or cc             yes - /usr/bin/gcc                          which gcc
- iconv                 no                                          iconv --version
- Text::Iconv           no                                          perl -MText::Iconv -e '{print $Text::Iconv::VERSION . "\n"}'
- HTML::Template        no                                          perl -MHTML::Template -e '{print $HTML::Template::VERSION . "\n"}'

A quick method to install these needed items:
pkg_add -r perl
pkg_add -r p5-Text-Iconv
pkg_add -r p5-HTML-Template

Quick Install for FreeBSD 8.2-RELEASE
=====================================
# become root
su -

# make tmp dir to unpack openwebmail
mkdir /tmp/openwebmail
cd /tmp/openwebmail

# download -current version
fetch http://openwebmail.acatysmoof.com/download/current/openwebmail-current.tar.gz

# unpack it
tar -xvzBpf openwebmail-current.tar.gz

# put it in the apache area
mv cgi-bin/openwebmail /usr/local/www/cgi-bin/
mv data/openwebmail /usr/local/www/html/

# cleanup
cd /usr/local/www/cgi-bin/openwebmail
rm -rf /tmp/openwebmail

# create the logfile
touch /var/log/openwebmail.log
chown root:mail /var/log/openwebmail.log

# ONLY if you do not have an index file - use the provided redirect file
cp -p /usr/local/www/data/openwebmail/redirect.html /usr/local/www/data/index.html

# ONLY if your Perl is older than 5.12.0 and does NOT support setuid, manually wrap
# the openwebmail*.pl files in a c-wrapper to enable setuid
chmod 777 ./misc/tools/wrapsuid/wrapsuid.pl
./misc/tools/wrapsuid/wrapsuid.pl /usr/local/www/cgi-bin/openwebmail/openwebmail*.pl
chmod 660 ./misc/tools/wrapsuid/wrapsuid.pl

# initialize openwebmail
# (.pl files will automatically be C wrapped if perl version is 5.12 or higher)
./openwebmail-tool.pl --init

# if c-wrapped, perl code has now been moved to hidden files of the same name
# original perl file: .openwebmail-abook.pl
# c-wrapper file: openwebmail-abook.pl

# setuid the .pl files
chmod 4755 openwebmail*.pl

# ONLY if you are upgrading from a previous version of OpenWebMail
# do you need to reindex all existing users databases to the new format
# This step can take a while and should be done while no one is accessing
# the system. Access from an old version will force the db to roll back
# to the old format
./openwebmail-tool.pl --alluser --index

# go to the openwebmail page in your browser
http://your.domain/cgi-bin/openwebmail/openwebmail.pl

Questions?
==========
http://openwebmail.acatysmoof.com/archive
