Overview
========
OpenWebMail can run on Debian 6.0 "Squeeze" with very little effort.
This HOW-TO was written against version 6.0.1a.

Mimimum Requirements    Already Installed on Debian Squeeze?   How To Tell
====================    ====================================   ===========
- gcc or cc             yes - /usr/bin/gcc                     which gcc
- iconv                 yes - version 2.11.2                   iconv --version
- Text::Iconv           yes - version 1.7                      perl -MText::Iconv -e '{print $Text::Iconv::VERSION . "\n"}'
- HTML::Template        no                                     perl -MHTML::Template -e '{print $HTML::Template::VERSION . "\n"}'

Quick Install for Debian Squeeze
================================
# become root
su -

# install required HTML::Template perl module (network connection required)
cpan HTML::Template

# make tmp dir to unpack openwebmail
mkdir /tmp/openwebmail
cd /tmp/openwebmail

# download -current version
wget http://openwebmail.acatysmoof.com/download/current/openwebmail-current.tar.gz

# unpack it
tar -xvzBpf openwebmail-current.tar.gz

# put it in the apache area
mv cgi-bin/openwebmail /usr/lib/cgi-bin/
mkdir /var/www/html
mv data/openwebmail /var/www/html

# cleanup
cd /usr/lib/cgi-bin/openwebmail
rm -rf /tmp/openwebmail

# create the logfile
touch /var/log/openwebmail.log
chown root:mail /var/log/openwebmail.log

# ONLY if you do not have an index file - use the provided redirect file
cp -p /var/www/html/openwebmail/redirect.html /var/www/html/index.html

# update openwebmail.conf
vi etc/openwebmail.conf
change:
ow_cgidir               /usr/local/www/cgi-bin/openwebmail
ow_cgiurl               /cgi-bin/openwebmail
ow_htmldir              /usr/local/www/data/openwebmail
ow_htmlurl              /openwebmail

to:
ow_cgidir               /usr/lib/cgi-bin/openwebmail
ow_cgiurl               /cgi-bin/openwebmail
ow_htmldir              /var/www/html/openwebmail
ow_htmlurl              /html/openwebmail

# create an auth_unix.conf config file for Debian
cp etc/defaults/auth_unix.conf etc/

# update the auth_unix.conf file
vi etc/auth_unix.conf
change:
passwdfile_plaintext    /etc/passwd
passwdfile_encrypted    /etc/master.passwd
passwdmkdb              /usr/sbin/pwd_mkdb

to:
passwdfile_plaintext    /etc/passwd
passwdfile_encrypted    /etc/shadow
passwdmkdb              none

# create a dbm.conf file for Debian
cp etc/defaults/dbm.conf etc/

# update the dbm.conf config file
vi etc/dbm.conf
change:
dbm_ext           .db
dbmopen_ext       none
dbmopen_haslock   no

to:
dbm_ext           .pag
dbmopen_ext       none
dbmopen_haslock   no

# Debian Squeeze does not come with a setuid enabled Perl.
# You can still run the openwebmail-*.pl files setuid by
# manually C wrapping them with the wrapsuid.pl script that
# comes with OpenWebMail
chmod 4755 ./misc/tools/wrapsuid/wrapsuid.pl
./misc/tools/wrapsuid/wrapsuid.pl /usr/lib/cgi-bin/openwebmail/openwebmail*.pl
chmod 600 ./misc/tools/wrapsuid/wrapsuid.pl

# setuid the C-wrapped .pl files
chmod 4755 openwebmail*.pl

# initialize openwebmail
./openwebmail-tool.pl --init

# ONLY if you are upgrading from a previous version of OpenWebMail
# do you need to reindex all existing users databases to the new format
# This step can take a while and should be done while no one is accessing
# the system. Access from an old version will force the db to roll back
# to the old format
./openwebmail-tool.pl --alluser --index

# go to the openwebmail page in your browser
http://your.domain/cgi-bin/openwebmail/openwebmail.pl

Questions?
==========
http://openwebmail.acatysmoof.com/archive
