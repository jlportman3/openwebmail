<tmpl_var header_template escape="none">

<form action="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl" method="post" name="editbooksForm" id="editbooksForm">
<input type="hidden" name="action" value="addrbookedit">
<input type="hidden" name="sessionid" value="<tmpl_var sessionid escape="html">">

<input type="hidden" name="folder" value="<tmpl_var folder escape="html">">
<input type="hidden" name="sort" value="<tmpl_var sort escape="html">">
<input type="hidden" name="msgdatetype" value="<tmpl_var msgdatetype escape="html">">
<input type="hidden" name="message_id" value="<tmpl_var messageid escape="html">">
<input type="hidden" name="page" value="<tmpl_var page escape="html">">
<input type="hidden" name="longpage" value="<tmpl_var longpage escape="html">">
<input type="hidden" name="searchtype" value="<tmpl_var searchtype escape="html">">
<input type="hidden" name="keyword" value="<tmpl_var keyword escape="html">">

<input type="hidden" name="abookfolder" value="<tmpl_var abookfolder escape="html">">
<input type="hidden" name="abooksort" value="<tmpl_var abooksort escape="html">">
<input type="hidden" name="abookpage" value="<tmpl_var abookpage escape="html">">
<input type="hidden" name="abooklongpage" value="<tmpl_var abooklongpage escape="html">">
<input type="hidden" name="abooksearchtype" value="<tmpl_var abooksearchtype escape="html">">
<input type="hidden" name="abookkeyword" value="<tmpl_var abookkeyword escape="html">">
<input type="hidden" name="abookcollapse" value="<tmpl_var abookcollapse escape="html">">

<input type="hidden" name="targetbook" value=""><!-- set by javascript delete and rename -->

<table cellpadding="0" cellspacing="0" border="0" align="center" width="95%">
<tr>
  <td colspan="5" class="titlebar">
    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
      <td nowrap class="titlebar" width="30%">Manage Addressbooks</td>
      <td nowrap class="titlebar" align="center">&nbsp;</td>
      <td nowrap class="titlebar" align="right" width="30%"><tmpl_var availablefreespace escape="html"> KB Available&nbsp;</td>
    </tr>
    </table>
  </td>
</tr>
<tr>
  <td colspan="5" class="menubar">
    <a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addrlistview&amp;message_id=<tmpl_var messageid escape="url">&amp;headers=<tmpl_var headers escape="url">&amp;attmode=simple&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;abookfolder=<tmpl_var abookfolder escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" accesskey="B" class="icon" name="backlink" id="backlink"><tmpl_if use_texticon>back to <tmpl_var abookfolder_label escape="html"><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/backtofolder.gif" title="back to <tmpl_var abookfolder_label escape="html">" alt="back to <tmpl_var abookfolder_label escape="html">" border="0" align="absmiddle"></tmpl_if></a>
  </td>
</tr>
<tr>
  <td colspan="5">&nbsp;</td>
</tr>
<tr>
  <td width="10" class="columnheader">&nbsp;</td>
  <td class="columnheader">Addressbook Name (<tmpl_var foldername_maxlength escape="html"> characters)</td>
  <td align="center" class="columnheader">Entries</td>
  <td align="center" class="columnheader">Size</td>
  <td align="center" class="columnheader">Action</td>
</tr>
<tr>
  <td width="10" class="rowlight">&nbsp;</td>
  <td class="rowlight"><input type="text" name="abookfoldernew" value="" size="24" maxlength="<tmpl_var foldername_maxlength escape="html">" accesskey="I"></td>
  <td align="center" class="rowlight">&nbsp;</td>
  <td align="center" class="rowlight">&nbsp;</td>
  <td align="center" class="rowlight"><input type="submit" name="function" value="add" accesskey="A"></td>
</tr>

<tmpl_loop addressbooksloop>
<tr>
  <td width="10" class="<tmpl_if odd>rowlight<tmpl_else>rowdark</tmpl_if>">&nbsp;</td>
  <td class="<tmpl_if odd>rowlight<tmpl_else>rowdark</tmpl_if>">
    <input type="hidden" name="abookfolder_<tmpl_var count escape="html">" value="<tmpl_var abookfolder escape="html">">
    <a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addrbookdownload&amp;sessionid=<tmpl_var sessionid escape="url">&amp;abookfolder=<tmpl_var abookfolder escape="url">" accesskey="W" class="icon"><tmpl_if use_texticon>download<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/download.gif" title="download" alt="download" border="0" align="absmiddle"></tmpl_if></a>&nbsp;
    <a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addrlistview&amp;message_id=<tmpl_var messageid escape="url">&amp;headers=<tmpl_var headers escape="url">&amp;attmode=simple&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;abookfolder=<tmpl_var abookfolder escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" accesskey="B" title="view this addressbook"><tmpl_var abookfolder_label escape="html"></a>
  </td>
  <td align="center" class="<tmpl_if odd>rowlight<tmpl_else>rowdark</tmpl_if>"><tmpl_var abookfolder_entries escape="html"></td>
  <td align="center" class="<tmpl_if odd>rowlight<tmpl_else>rowdark</tmpl_if>"><tmpl_var abookfolder_size escape="html"></td>
  <td align="center" class="<tmpl_if odd>rowlight<tmpl_else>rowdark</tmpl_if>" nowrap>
    <tmpl_if is_writable>
    <table cellpadding="0" cellspacing="0" border="0">
    <tr>
      <td><input type="submit" name="function" value="delete" onclick="return opconfirm('delete', 'abookfolder_<tmpl_var count escape="html">')"></td>
      <td><input type="submit" name="function" value="rename" onclick="return opconfirm('rename', 'abookfolder_<tmpl_var count escape="html">')"></td>
    </tr>
    </table>
    <tmpl_else>
    -- read only --
    </tmpl_if>
  </td>
</tr>
</tmpl_loop>

<tr>
  <td colspan="5">&nbsp;</td>
</tr>
<tr>
  <td width="10" class="columnheader">&nbsp;</td>
  <td class="columnheader">Global Addressbooks</td>
  <td align="center" class="columnheader">Entries</td>
  <td align="center" class="columnheader">Size</td>
  <td align="center" class="columnheader">&nbsp;</td>
</tr>

<tmpl_loop globaladdressbooksloop>
<tr>
  <td width="10" class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>">&nbsp;</td>
  <td class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>">
    <a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addrbookdownload&amp;sessionid=<tmpl_var sessionid escape="url">&amp;abookfolder=<tmpl_var abookfolder escape="url">" accesskey="W" class="icon"><tmpl_if use_texticon>download<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/download.gif" title="download" alt="download" border="0" align="absmiddle"></tmpl_if></a>&nbsp;
    <a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addrlistview&amp;message_id=<tmpl_var messageid escape="url">&amp;headers=<tmpl_var headers escape="url">&amp;attmode=simple&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;abookfolder=<tmpl_var abookfolder escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" accesskey="B" title="view this addressbook"><tmpl_var abookfolder_label escape="html"></a>
  </td>
  <td align="center" class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"><tmpl_var abookfolder_entries escape="html"></td>
  <td align="center" class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"><tmpl_var abookfolder_size escape="html"></td>
  <td align="center" class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>">&nbsp;</td>
</tr>
</tmpl_loop>

<tr>
  <td colspan="5">&nbsp;</td>
</tr>
<tr>
  <td width="10" class="<tmpl_if odd>rowlight<tmpl_else>rowdark</tmpl_if>">&nbsp;</td>
  <td class="<tmpl_if odd>rowlight<tmpl_else>rowdark</tmpl_if>"><b>Total</b></td>
  <td align="center" class="<tmpl_if odd>rowlight<tmpl_else>rowdark</tmpl_if>"><b><tmpl_var totalentries escape="html"></b></td>
  <td align="center" class="<tmpl_if odd>rowlight<tmpl_else>rowdark</tmpl_if>"><b><tmpl_var totalsizes escape="html"></b></td>
  <td align="center" class="<tmpl_if odd>rowlight<tmpl_else>rowdark</tmpl_if>">&nbsp;</td>
</tr>
</table>

</form>

<script type="text/javascript">
<!--
function opconfirm(op, abookfolder_index) {
   var abookfoldername = document.editbooksForm.elements[abookfolder_index].value;

   if (op == 'delete') {
      if(confirm('Are you sure you want to delete this folder and all its contents? (' + abookfoldername + ')')) {
         document.editbooksForm.targetbook.value = abookfoldername;
         return true;
      } else {
         return false;
      }
   } else if (op == 'rename') {
      var newname = prompt('Please enter the new name for this folder', abookfoldername);
      if (newname == abookfoldername || newname == null || newname == '') {
         return false;
      }
      document.editbooksForm.targetbook.value = abookfoldername;
      document.editbooksForm.abookfoldernew.value = newname;
      return true;
   }

   return false; // never reached
}
//-->
</script>

<tmpl_var footer_template escape="none">
